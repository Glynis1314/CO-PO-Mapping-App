{% extends "base.html" %}

{% block title %}Assign Subjects — Attainment Prototype{% endblock %}

{% block content %}
<div class="container-fluid py-4">
  <div class="row">
    <div class="col-md-3">
      {% include "components/sidebar_hod.html" %}
    </div>

    <div class="col-md-9">
      <h3 class="mb-4">Assign Subjects to Teachers</h3>

      {% if messages %}
        {% for message in messages %}
          <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
            {{ message }}
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
          </div>
        {% endfor %}
      {% endif %}

      <div class="card shadow-sm mb-4">
        <div class="card-body">
          <form method="POST" action="{% url 'assign_subject' %}" class="row g-3 align-items-end">
            {% csrf_token %}
            <div class="col-md-4">
              <label class="form-label font-weight-bold">Subject</label>
              <select name="course_id" class="form-select" required>
                <option value="" selected disabled>Choose Subject...</option>
                {% for course in courses %}
                  <option value="{{ course.id }}">{{ course.code }} — {{ course.name }}</option>
                {% endfor %}
              </select>
            </div>
            <div class="col-md-4">
              <label class="form-label font-weight-bold">Teacher</label>
              <select name="teacher_id" class="form-select" required>
                <option value="" selected disabled>Choose Teacher...</option>
                {% for teacher in teachers %}
                  <option value="{{ teacher.id }}">{{ teacher.username }}</option>
                {% endfor %}
              </select>
            </div>
            <div class="col-md-2">
              <button type="submit" class="btn btn-primary w-100">Assign</button>
            </div>
          </form>

          <hr class="my-4">

          <h6>Current Assignments</h6>
          <ul class="list-group list-group-flush">
            {% for assignment in assignments %}
              <li class="list-group-item d-flex justify-content-between align-items-center">
                <span><strong>{{ assignment.course.code }}</strong> &rarr; {{ assignment.teacher.username }}</span>
                <span class="badge bg-success rounded-pill">Active</span>
              </li>
            {% empty %}
              <li class="list-group-item text-muted text-center italic">No assignments found for this cycle.</li>
            {% endfor %}
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}