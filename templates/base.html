{% load static %}
<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<title>{% block title %}Attainment System Prototype{% endblock %}</title>

		<!-- Bootstrap 5 CSS CDN (load first) -->
		<link
			href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
			rel="stylesheet"
		/>
		<link
			href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css"
			rel="stylesheet"
		/>
		<!-- Your custom CSS (overrides Bootstrap) -->
		<link rel="stylesheet" href="{% static 'css/styles.css' %}" />

		{% block extra_head %}{% endblock %}

		<style>
			/* Small prototype-friendly overrides */
			body {
				padding-top: 0px;
			}
			main {
				padding-top: 56px;
			}
			.app-footer {
				font-size: 0.9rem;
				opacity: 0.9;
			}
			.card-role {
				cursor: pointer;
				transition: transform 0.12s ease;
			}
			.card-role:hover {
				transform: translateY(-4px);
			}
			nav .nav-link.active {
				margin-top: 0 !important;
				padding-top: 0 !important;
			}
		</style>
	</head>
	<body>
		<!-- Top navbar -->
		<nav
			class="navbar navbar-expand-lg navbar-dark bg-primary fixed-top shadow-sm"
		>
			<div class="container-fluid">
				<a class="navbar-brand d-flex align-items-center" href="/">
					<!-- use logo.svg if that's what exists; change to logo.png if you have a PNG -->
					<img
						src="{% static 'images/logo.svg' %}"
						alt="logo"
						width="36"
						height="36"
						class="me-2 rounded"
					/>
					<span>DBIT — Attainment</span>
				</a>

				<button
					class="navbar-toggler"
					type="button"
					data-bs-toggle="collapse"
					data-bs-target="#topNav"
					aria-controls="topNav"
					aria-expanded="false"
					aria-label="Toggle navigation"
				>
					<span class="navbar-toggler-icon"></span>
				</button>

				<div class="collapse navbar-collapse" id="topNav">
					<ul class="navbar-nav ms-auto mb-2 mb-lg-0">
						{% if user.is_authenticated %}
							{% if user.profile.role == 'ADMIN' %}
								<li class="nav-item"><a class="nav-link" href="{% url 'admin_dashboard' %}">Dashboard</a></li>
								<li class="nav-item"><a class="nav-link" href="{% url 'admin_academic_years' %}">Academic Years</a></li>
								<li class="nav-item"><a class="nav-link" href="{% url 'admin_courses' %}">Courses</a></li>
								<li class="nav-item"><a class="nav-link" href="{% url 'settings_users' %}">Users</a></li>
								<li class="nav-item"><a class="nav-link" href="{% url 'attainment_report' %}">Reports</a></li>
							{% elif user.profile.role == 'HOD' %}
								<li class="nav-item"><a class="nav-link" href="{% url 'dashboard_hod' %}">Dashboard</a></li>
								<li class="nav-item"><a class="nav-link" href="{% url 'academic_years_list' %}">Academic Years</a></li>
								<li class="nav-item"><a class="nav-link" href="{% url 'attainment_report' %}">Reports</a></li>
								<li class="nav-item"><a class="nav-link" href="{% url 'evidence_upload' %}">Evidence</a></li>
							{% elif user.profile.role == 'TEACHER' %}
								<li class="nav-item"><a class="nav-link" href="{% url 'teacher_dashboard' %}">Dashboard</a></li>
							{% endif %}
						{% else %}
							<li class="nav-item"><a class="nav-link" href="{% url 'login' %}">Sign in</a></li>
						{% endif %}
					</ul>

					<!-- Auth section -->
					<div class="d-flex align-items-center ms-3">
						{% if user.is_authenticated %}
							<div class="text-white me-2 small">
								<i class="bi bi-person-circle me-1"></i>
								<strong>{{ user.get_full_name|default:user.username }}</strong>
								{% if user.profile %}
									<span class="badge bg-light text-primary ms-1">{{ user.profile.get_role_display }}</span>
								{% endif %}
							</div>
							<a class="btn btn-outline-light btn-sm ms-2" href="{% url 'logout' %}">
								<i class="bi bi-box-arrow-right me-1"></i>Sign out
							</a>
						{% else %}
							<a class="btn btn-outline-light btn-sm ms-2" href="{% url 'login' %}">
								<i class="bi bi-box-arrow-in-right me-1"></i>Sign in
							</a>
						{% endif %}
					</div>
				</div>
			</div>
		</nav>

		<!-- Main content -->
		<main class="container-fluid">
			<div class="row g-0">
				<!-- Sidebar column: include sidebar inside but it will be fixed by CSS -->
				<div class="col-auto">{% block sidebar %}{% endblock %}</div>

				<!-- Main content column -->
				<div class="col">
					<div class="container py-4">
						<div class="main-content">
							{% block content %}
							<div class="text-center py-5">
								<h1 class="display-6">Attainment System Prototype</h1>
								<p class="lead">
									Use the role cards on the landing page to open dashboards
									(prototype links).
								</p>
							</div>
							{% endblock %}
						</div>
					</div>
				</div>
			</div>
		</main>

		<!-- Footer -->
		<footer
			class="bg-light text-center text-muted py-3 border-top mt-auto app-footer"
		>
			<div class="container">
				<div>
					DBIT — SO/PO Attainment Prototype &middot;
					<small>For demo only</small>
				</div>
				<div class="small">
					Built for: HOD, Department, Principal, Teachers | Academic Year:
					<span id="footer-year">2025-26</span>
				</div>
			</div>
		</footer>

		<!-- Bootstrap 5 JS bundle (popper included) -->
		<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

		<!-- Optional custom JS -->
		<script src="{% static 'js/main.js' %}"></script>

		{% block extra_js %}{% endblock %}
	</body>
</html>
